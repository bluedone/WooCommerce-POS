var POS=function(a){return a.module("SettingsApp",function(a,b){a.startWithParent=!1,a.onStart=function(){b.debug&&console.log("POS Settings Module started"),new a.Controller}}),a}(POS||{}),POS=function(a,b,c,d,e){return a.SettingsApp.Controller=c.Controller.extend({initialize:function(){this.settingsRegion=new c.Region({el:"#wc-pos-settings"});var d=b.Model.extend({url:ajaxurl,defaults:{action:"wc_pos_save_admin_settings"}});this.settingsCollection=new b.Collection(a.bootstrap,{model:d}),this._showTabs(),this._showSettings({tab:"general"})},_showTabs:function(){var b=new a.SettingsApp.Views.Tabs;this.listenTo(b,"settings:tab:clicked",function(a){this._showSettings({tab:a})},this)},_showSettings:function(b){e.defaults(b,{col:this.settingsCollection});var c=new a.SettingsApp.Views.Settings(b);this.listenTo(c,"settings:form:submit",function(a){this._saveSettings(a)}),this.settingsRegion.show(c)},_saveSettings:function(a){a.save([],{data:a.toJSON(),emulateHTTP:!0,emulateJSON:!0})}}),a}(POS||{},Backbone,Marionette,jQuery,_),POS=function(a,b,c,d,e){return a.SettingsApp.Views={},a.SettingsApp.Views.Tabs=c.ItemView.extend({el:"#wc-pos-settings-tabs",initialize:function(){this.$("a.nav-tab").first().addClass("nav-tab-active")},events:{"click a":"onTabClicked"},onTabClicked:function(a){a.preventDefault();var b=d(a.target);b.hasClass("nav-tab-active")||(this.trigger("settings:tab:clicked",b.data("tab")),b.addClass("nav-tab-active").siblings("a.nav-tab-active").removeClass("nav-tab-active"))}}),a.SettingsApp.Views.Settings=c.ItemView.extend({tagName:"form",initialize:function(a){this.settingsCollection=a.col||{},this.template=e.template(d("#tmpl-wc-pos-settings-"+a.tab).html())},ui:{submit:'input[type="submit"]',id:'input[name="id"]'},events:{"click @ui.submit":"onSubmit"},behaviors:{Select2:{}},onBeforeShow:function(){var a=this.ui.id.val();this.model=this.settingsCollection.get(a),e.isUndefined(this.model)||b.Syphon.deserialize(this,this.model.toJSON()),this.listenTo(this.model,"request change:response",this.saving)},onBeforeDestroy:function(){this.storeState()},onSubmit:function(a){a.preventDefault(),this.trigger("settings:form:submit",this.storeState())},storeState:function(){var a=b.Syphon.serialize(this);return this.settingsCollection.add(a,{merge:!0})},saving:function(a){e(a.changed).isEmpty()?this.ui.submit.prop("disabled",!0).after('<span class="spinner"></span>"'):this.ui.submit.prop("disabled",!1),this.model.unset("response",{silent:!0})}}),a}(POS||{},Backbone,Marionette,jQuery,_);