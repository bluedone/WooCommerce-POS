var POS=function(a){return a.module("SettingsApp",function(a,b){a.startWithParent=!1,a.onStart=function(){b.debug&&console.log("POS Settings Module started"),new a.Controller}}),a}(POS||{}),POS=function(a,b,c,d,e){return a.SettingsApp.Controller=c.Controller.extend({initialize:function(){this.settingsRegion=new c.Region({el:"#wc-pos-settings"});var a=b.Model.extend({idAttribute:"key"}),d=b.Collection.extend({model:a});this.settingsCollection=new d,this._showTabs(),this._showSettings({tab:"general"})},_showTabs:function(){var b=new a.SettingsApp.Views.Tabs;this.listenTo(b,"settings:tab:clicked",function(a){this._showSettings({tab:a})},this)},_showSettings:function(b){e.defaults(b,{col:this.settingsCollection});var c=new a.SettingsApp.Views.Settings(b);this.listenTo(c,"settings:form:submit",function(a){this._saveSettings(a)}),this.settingsRegion.show(c)},_saveSettings:function(a){console.log(a),a.action="wc_pos_save_admin_settings",d.post(ajaxurl,a,function(a){console.log(a)})}}),a}(POS||{},Backbone,Marionette,jQuery,_),POS=function(a,b,c,d,e){return a.SettingsApp.Views={},a.SettingsApp.Views.Tabs=c.ItemView.extend({el:"#wc-pos-settings-tabs",initialize:function(){this.$("a.nav-tab").first().addClass("nav-tab-active")},events:{"click a":"onTabClicked"},onTabClicked:function(a){a.preventDefault();var b=d(a.target);b.hasClass("nav-tab-active")||(this.trigger("settings:tab:clicked",b.data("tab")),b.addClass("nav-tab-active").siblings("a.nav-tab-active").removeClass("nav-tab-active"))}}),a.SettingsApp.Views.Settings=c.ItemView.extend({tagName:"form",saving:!1,initialize:function(a){this.settingsCollection=a.col||{},this.template=e.template(d("#tmpl-wc-pos-settings-"+a.tab).html())},onBeforeShow:function(){var a=this.$('input[name="key"]').val(),c=this.settingsCollection.get(a);c?b.Syphon.deserialize(this,c.toJSON()):this.storeState()},onBeforeDestroy:function(){this.storeState()},events:{"click input[type=submit]":"onSubmit"},onSubmit:function(){var a=this.storeState();this.trigger("settings:form:submit",a)},storeState:function(){var a=b.Syphon.serialize(this);return this.settingsCollection.add(a,{merge:!0}),a}}),a}(POS||{},Backbone,Marionette,jQuery,_);