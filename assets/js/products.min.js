!function(a){"use strict";a(function(){{var b=Backbone.Model.extend({url:ajaxurl,idAttribute:"name",save:function(){var a={emulateJSON:!0,data:{action:"pos_set_product_visibilty",_pos_visibility:this.get("name"),post_id:pos_params.post_id,security:pos_params.visibility_nonce}};return Backbone.sync("create",this,a)}}),c=Backbone.Collection.extend({model:b}),d=Backbone.View.extend({el:a("#pos-visibility"),template:_.template(a("#tmpl-pos-visibility").html()),events:{"click a":"clicked"},initialize:function(){this.collection=new c(pos_params.visibility),this.render()},render:function(){return this.$("#pos-visibility-select").html(this.template({options:this.collection.toJSON()})),this},clicked:function(b){b.preventDefault();var c=b.target.className.match(/\s?action-([a-z]+)/);if(c){var d=this;switch(c[1]){case"edit":this.$(".action-edit").hide(),this.$("#pos-visibility-select").slideToggle();break;case"save":var e=this.$("input:checked").val(),f=this.collection.get(e);this.$(".spinner").css({display:"inline-block","float":"none"}),f.save().done(function(){console.log(this),a("#pos-visibility-display").text(f.get("label")),d.closeDiv()}).fail(function(){a("#pos-visibility-select").prepend('<p class="form-invalid" style="padding:5px;margin-top:0;">Error</p>'),d.$(".spinner").removeAttr("style")});break;case"cancel":this.closeDiv()}}},closeDiv:function(){var a=this;a.$(".spinner").removeAttr("style"),this.$("#pos-visibility-select").slideToggle(400,function(){a.$(".action-edit").show(),a.$(".form-invalid").remove()})}});new d}})}(jQuery);