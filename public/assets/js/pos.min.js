!function(a){"use strict";if("undefined"==typeof pos_cart_params)return console.log("No pos_cart_params"),!1;{var b=Backbone.Model.extend({defaults:{cart_hash:"default-cart-hash",fragments:"There seems to be a problem getting the cart :("}}),c=new b,d=Backbone.Collection.extend({model:b,url:pos_cart_params.ajax_url,parse:function(a){return console.log("updating cart"),console.log(a),c.set(a),a}}),e=new d,f=Backbone.View.extend({el:a("#cart"),initialize:function(){console.log("initializing cart"),e.on("add",this.render,this),e.on("reset",this.render,this),mediator.subscribe("updateCart",function(){e.fetch({data:{action:"pos_get_refreshed_fragments"},processData:!0,reset:!0})})},render:function(){console.log("rendering cart"),this.$el.html(c.get("fragments"))},events:{"click a.remove-from-cart":"removeFromCart","click #pos_checkout":"checkout"},removeFromCart:function(b){b.preventDefault();var d={action:"pos_remove_item",href:a(b.currentTarget).attr("href")};a.post(pos_cart_params.ajax_url,d,function(a){return a?a.error?void console.log(a.error):(c.set(a),e.reset(),void console.log("new cart_hash: "+c.get("cart_hash"))):void console.log("No response from server")})},checkout:function(b){b.preventDefault();var d={action:"pos_process_order",cart_hash:c.get("cart_hash"),cart:a("#cart form").serialize()};a.post(pos_cart_params.ajax_url,d,function(a){return a?a.error?void console.log(a.error):(c.set(a),e.reset(),void console.log("order id: "+c.get("cart_hash"))):void console.log("No response from server")})}});new f}e.fetch({data:{action:"pos_get_refreshed_fragments"},processData:!0,reset:!0})}(jQuery),function(a){"use strict";a("#user-actions-btn, #user-actions").hover(function(){a("#user-actions").show()},function(){a("#user-actions").hide()})}(jQuery),function(a){"use strict";if("undefined"==typeof pos_cart_params)return console.log("No pos_cart_params"),!1;var b=Backbone.PageableCollection.extend({url:"/wc-api/v1/products",mode:"client",state:{pageSize:5},queryParams:{filter:{limit:-1}},parseState:function(a,b,c,d){var e=parseInt(d.xhr.getResponseHeader("X-WC-Total"));return{totalRecords:e}},parseRecords:function(a){return console.log(a),a.products}}),c=new b,d=new Backgrid.Grid({columns:[{name:"featured_src",label:"",cell:Backgrid.Cell.extend({render:function(){return this.$el.html('<img src="'+this.model.get("featured_src")+'">'),this}}),sortable:!1,editable:!1},{name:"title",label:"Product",cell:Backgrid.Cell.extend({render:function(){var a="<strong>"+this.model.get("title")+"</strong>",b="variation"===this.model.get("type")?this.model.get("variation_html"):"",c=this.model.get("managing_stock")===!1?"":"<small>"+this.model.get("stock_quantity")+" in stock</small>";return this.$el.html(a+b+c),this}}),sortable:!1,editable:!1},{name:"price_html",label:"Price",cell:Backgrid.Cell.extend({render:function(){return this.$el.html(this.model.get("price_html")),this}}),sortable:!1,editable:!1},{name:"add",label:"",cell:Backgrid.Cell.extend({events:{"click a.add-to-cart":"addToCart"},render:function(){var b=this.model.get("id"),c="",d="?"+a.param({"add-to-cart":b});"variation"===this.model.get("type")&&(b=this.model.get("parent_id"),c=this.model.get("id"),d="?"+a.param({"add-to-cart":b,variation_id:c}));var e='<a class="add-to-cart btn btn-circle btn-flat-action" href="'+d+'" data-id="'+b+'" data-variation_id="'+c+'"><i class="fa fa-plus"></i></a>';return this.$el.html(e),this},addToCart:function(b){b.preventDefault();var c=a(b.currentTarget).attr("data-id"),d=a(b.currentTarget).attr("data-variation_id"),e={action:"pos_add_to_cart",id:c,variation_id:d};a.post(pos_cart_params.ajax_url,e,function(a){return a?a.error?void console.log(a.error):void mediator.publish("updateCart"):void console.log("No response from server")})}}),sortable:!1,editable:!1}],collection:c}),e=new Backgrid.Extension.Paginator({collection:c,renderIndexedPageHandles:!1,controls:{rewind:null,fastForward:null,back:{label:'<i class="fa fa-chevron-left"></i>',title:"Previous"},forward:{label:'<i class="fa fa-chevron-right"></i>',title:"Next"}}}),f=new Backgrid.Extension.ClientSideFilter({collection:c,fields:["title"],placeholder:"Search products"});a("#filter").append(f.render().$el),a("#products").html(d.render().$el),a("#pagination").html(e.render().$el),console.log("fetching products"),c.fetch({reset:!0}).complete(function(){console.log("products received")})}(jQuery);
//# sourceMappingURL=pos.min.map